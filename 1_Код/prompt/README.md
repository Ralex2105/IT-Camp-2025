# Система обнаружения и классификации дефектов в электрических системах

## Описание проекта

Проект реализует систему машинного обучения для обнаружения и
классификации дефектов в электрических системах на основе анализа
сигнатур тока.\
Используется обработка временных рядов, выделение признаков и обучение
моделей для многоклассовой классификации.

### Основные возможности

-   **Полный пайплайн обработки данных:**
    -   загрузка и предобработка данных;
    -   извлечение признаков (и таргета, при обучении) из сигналов тока
        с помощью математической модели;
    -   трансформация таргета (кодирование).
-   **Двухэтапная классификация:**
    -   определение типа дефекта;
    -   определение степени его тяжести.
-   **Поддержка классов дефектов:** `Inner Race`, `Outer Race`, `Ball`,
    `Cage`, `Rotor`, `Misalignment`, `Normal`.
-   **Поддержка степени тяжести:** `None`, `Low`, `Medium`, `High`.
-   **Обучение и инференс с использованием CatBoost**.

------------------------------------------------------------------------

## Технический стек

-   **Язык:** Python 3.12+
-   **Основные библиотеки:**
    -   [CatBoost](https://catboost.ai/) --- обучение моделей
        классификации;
    -   [scikit-learn](https://scikit-learn.org/) --- метрики и
        разбиение данных;
    -   [pandas](https://pandas.pydata.org/) --- обработка таблиц;
    -   [numpy](https://numpy.org/) --- численные вычисления;
    -   [FastAPI](https://fastapi.tiangolo.com/) --- создание API для
        backend;
    -   [Uvicorn](https://www.uvicorn.org/) --- запуск frontend.

------------------------------------------------------------------------

## Структура проекта

``` bash
project/
├── data/
│   ├── data_raw/            # Измерения тока
│   ├── data_processed/      # Предобработанные данные
│   ├── data_feature/        # Выделенные признаки и таргет
│   ├── data_summary/        # Результаты работы (отчеты)
│   └── data_ml/             # Данные для инференса и генерации отчетов
│
├── model/
│   ├── model_defect.cbm     # Модель классификации дефектов
│   └── model_severity.cbm   # Модель классификации степени дефектов
│
├── public/                  # Веб-интерфейс
│   ├── index.html
│   ├── script.js
│   └── style.css
│
├── src/
│   ├── feature_extraction/  # Модуль извлечения признаков
│   ├── load_preprocessing/  # Загрузка и предобработка данных
│   ├── model/               # Логика моделей
│   ├── visualise_reports/   # Визуализация и отчеты
│   ├── app.py               # Основное приложение
│   ├── file_monitor.py      # Мониторинг файлов
│   ├── main.py              # Точка входа
│   └── monitor.py           # Утилиты мониторинга
│
├── requirements.txt         # Зависимости проекта
└── README.md                # Основная документация
```

------------------------------------------------------------------------

## Поток данных

``` mermaid
flowchart LR
    A[Сырые данные тока] --> B[Предобработка и очистка]
    B --> C[Извлечение признаков]
    C --> D[Подготовка обучающей выборки]
    D --> E[Обучение модели]
    E --> F[Предсказание типа дефекта]
    E --> G[Предсказание степени дефекта]
    F --> H[Отчеты и визуализации]
    G --> H[Отчеты и визуализации]
```

------------------------------------------------------------------------

## Гиперпараметры

    
    iterations = 200
    depth = 6
    learning_rate = 0.1
    loss_function = "MultiClass"
    random_seed = 42

------------------------------------------------------------------------

## Установка и запуск

### 1. Клонирование репозитория

``` bash
git clone https://github.com/Ralex2105/prompt
cd prompt
git checkout develop
```

> Если клонирование не с GitHub --- можно пропустить шаг с клонированием и веткой.

### 2. Настройка окружения

``` bash
python -m venv .venv
.\.venv\Scripts\activate.bat   # для Windows
source .venv/bin/activate  # для Linux/MacOS

pip install -r requirements.txt
```

### 3. Обучение модели

Решение поставлено уже с обученной моделью.

Лучше запускать процесс обучения после сохранения имеющихся cbm файлов.

Перед обучением необходимо поместить файлы .csv на ресурс:
``` bash
prompt/data/data

```
И запустить поочередно команды:

``` bash
python -m src.full_prep      # Предобработка и выделение признаков
python -m src.model.model    # Обучение модели и сохранение
```

> После обучения необходимо очистить директории данных:

``` bash
prompt/data/data
prompt/data/data_processed
prompt/data/data_features
```

### 4. Запуск системы

Перед началом работы директории в data не должны содержать файлов .csv

В 1-м терминале запустить:

``` bash
python -m src.monitor
```

Во 2-м терминале:

``` bash
uvicorn src.app:app --reload
```

После запуска перейти в браузере: **http://127.0.0.1:8000**

# Важно

- Логин и пароль лежит в файле .txt по пути:
``` bash
prompt/public/текст.txt
login: test.test@it.camp.ru
password: password123
```

------------------------------------------------------------------------


## Релизовано

- Выбор файла
- Обновление
- Окно авторизации и основной страницы

По итогу работы должны быть обновлены файлы на ресурсах:
``` bash
- data/data
- data/data_processed
- data/data_feature
- data/data_ml
- data/data_summary
```
Итоговый файл из data summary подтягиваются во frontend для отображения и скачивания пользователем

Интерфейс интуитивно понятный, проблем быть не должно

## Трудности

При возникновении трудностей - попытаться снова. 


При возникновении трудностей при попытке снова - попытаться снова.

Повторить 10 раз (у нас все работает :)))

Можно связаться с @RudnevAK в telegram


## Лицензия

MIT License